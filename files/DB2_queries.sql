### Total number of records in the table basket.

SELECT COUNT( * ) 
FROM DB2INST1.BASKET_HEADER

### Total revenues in the table basket.

SELECT SUM(SELLING_RETAIL_AMT) 
FROM DB2INST1.BASKET_HEADER

### Total number of customers in the table basket.

SELECT COUNT( DISTINCT CUSTOMER_SK) 
FROM DB2INST1.BASKET_HEADER

### Revenues for each date.

SELECT CALENDAR_DT, ROUND( SUM(SELLING_RETAIL_AMT) ) AS revenue
FROM DB2INST1.BASKET_HEADER
GROUP BY CALENDAR_DT

### Revenues for each day of the week.

SELECT DAYOFWEEK(CALENDAR_DT) AS Day, 
ROUND(SUM(SELLING_RETAIL_AMT )) AS Revenue
FROM DB2INST1.BASKET_HEADER
GROUP BY DAYOFWEEK(CALENDAR_DT)

### Revenues for each hour of the day.

SELECT HOUR(TRANSACTION_TM) AS HOUR , ROUND( SUM(SELLING_RETAIL_AMT) ) AS revenue
FROM DB2INST1.BASKET_HEADER
GROUP BY HOUR(TRANSACTION_TM)

### Revenues for each city.

SELECT m.CITY_NM , ROUND(SUM(b.SELLING_RETAIL_AMT)) AS revenue
FROM DB2INST1.MEMBER_DETAILS AS m, 
     DB2INST1.BASKET_HEADER AS b
WHERE m.CUSTOMER_SK = b.CUSTOMER_SK
GROUP BY m.CITY_NM
ORDER BY ROUND(SUM(b.SELLING_RETAIL_AMT)) DESC 

### Revenues for products.

SELECT ITEM_SK , ROUND( SUM(SELLING_RETAIL_AMT)) AS revenue
FROM DB2INST1.SALES_HEADER
GROUP BY ITEM_SK
ORDER BY ROUND( SUM(SELLING_RETAIL_AMT)) DESC 

### Popularity: Number of customers who bought a product (using product sku).

SELECT ITEM_SK, COUNT( DISTINCT CUSTOMER_SK) AS customers
FROM DB2INST1.SALES_HEADER
GROUP BY ITEM_SK
ORDER BY COUNT( DISTINCT CUSTOMER_SK) DESC

### Popularity: Number of customers who bought a product (using product name).

SELECT s.ITEM_SK, i.ITEM_ENG_DESC, COUNT( DISTINCT s.CUSTOMER_SK) AS customers
FROM DB2INST1.sales_HEADER AS s, DB2INST1.ITEMS_DETAILS AS i
WHERE s.ITEM_SK = i.ITEM_SK 
GROUP BY s.ITEM_SK, i.ITEM_ENG_DESC
ORDER BY COUNT( DISTINCT s.CUSTOMER_SK) DESC 

### Popularity: Number of baskets containing a product (using product sku)

SELECT ITEM_SK , COUNT( DISTINCT TRANSACTION_RK ) AS visits
FROM DB2INST1.SALES_HEADER
GROUP BY ITEM_SK
ORDER BY COUNT( DISTINCT TRANSACTION_RK ) DESC

### Popularity: Number of baskets containing bought a product (using product name).

SELECT s.ITEM_SK, i.ITEM_ENG_DESC, COUNT( DISTINCT s.TRANSACTION_RK) AS visits
FROM DB2INST1.SALES_HEADER AS s, DB2INST1.ITEMS_DETAILS AS i
WHERE s.ITEM_SK = i.ITEM_SK 
GROUP BY s.ITEM_SK, i.ITEM_ENG_DESC
ORDER BY COUNT( DISTINCT s.TRANSACTION_RK) DESC

### Revenues per customer.

SELECT CUSTOMER_SK , ROUND( SUM( SELLING_RETAIL_AMT ) ) AS revenue
FROM DB2INST1.BASKET_HEADER 
GROUP BY CUSTOMER_SK
ORDER BY ROUND( SUM( SELLING_RETAIL_AMT ) ) DESC 

### Loyalty: number of visits per customer.

SELECT CUSTOMER_SK , ROUND( COUNT( DISTINCT TRANSACTION_RK ) ) AS visits
FROM DB2INST1.BASKET_HEADER 
GROUP BY CUSTOMER_SK
ORDER BY ROUND( COUNT( DISTINCT TRANSACTION_RK ) ) DESC
